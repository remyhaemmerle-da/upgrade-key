module Test where

import Template
import Interface

import Daml.Script

template Helper
  with
    owner: Party
  where
    signatory owner
    choice Bug : () with
        cid : ContractId I
      controller owner
         do
          fetch cid
          pure ()

setup = script do
-- user_setup_begin
  alice <- allocatePartyWithHint "Alice" (PartyIdHint "Alice")
  aliceId <- validateUserId "Alice"
  createUser (User aliceId (Some alice)) [CanActAs alice]
-- user_setup_end
  cid <- submit alice do
    createCmd (T alice)
  _ <- submit alice do
    createAndExerciseCmd (Helper alice) (Bug $ coerceContractId cid)
  pure ()



